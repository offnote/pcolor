/*********************************************************
 * Licensed under the MIT licenses.
 * Copyright (c) M.Belikov www.offnote.net
*********************************************************/

(function($){$.fn.pColor=function(u){var v=["ffffff","e8e8e8","d1d1d1","bababa","a3a3a3","8c8c8c","757575","5e5e5e","474747","303030","111111","000000","c5edfc","ccdbfc","cfbbfc","eabcfc","f2c7d9","fad1cf","fbdbce","fde8cd","fdefcd","fcfdd7","f6fad5","d9eacb","8fddfb","9eb7fc","a274f9","d679fc","e991b3","f7a6a1","f9b89d","f8d19c","fadf9c","fdfcaf","edf7ad","c4e5a8","5dcbfa","6d93fa","7630f9","c238f9","de5b8d","f57871","f5956e","f6bb6a","f8d16a","fbfa89","e4f383","a5d77d","37b9f7","426ff9","500ee2","aa15ec","d32767","f24d45","f3723f","f4a63b","f5c13d","fbf963","dcef5c","8acb53","2d91cc","2946fa","3f0aa0","8310ad","a01e4b","f22f1e","f3571b","f39c1f","f4bd22","fbff42","cfeb3a","6aaf38","2479a3","213dc8","2d0880","640c8b","80173e","ce1713","c43f14","c17317","c18d1a","efeb26","b5ca26","588e2e","1b5a7a","192d97","220661","4b0967","60122f","9c110e","932e0f","915511","906913","b3b11c","87981c","416922","123c50","111f65","16013f","330645","3f0c1f","680c0a","621f0a","62390c","60460d","787513","5b6513","2d4716","0d2939","0b1443","10002d","22022f","2b0715","450706","431607","432708","412f09","51500d","3e450c","1e300f"];var w=['ffffff','000000','eeece1','1f497d','4f81bd','c0504d','9bbb59','8064a2','4bacc6','f79646','f2f2f2','7f7f7f','ddd9c3','c6d9f0','dbe5f1','f2dcdb','ebf1dd','e5e0ec','dbeef3','fdeada','d8d8d8','595959','c4bd97','8db3e2','b8cce4','e5b9b7','d7e3bc','ccc1d9','b7dde8','fbd5b5','bfbfbf','3f3f3f','938953','548dd4','95b3d7','d99694','c3d69b','b2a2c7','92cddc','fac08f','a5a5a5','262626','494429','17365d','366092','953734','76923c','5f497a','31859b','e36c09','7f7f7f','0c0c0c','1d1b10','0f243e','244061','632423','4f6128','3f3151','205867','974806','c00000','ff0000','ffc000','ffff00','92d050','00b050','00b0f0','0070c0','002060','7030a0'];var x=$.extend({onChange:function(){},fill:false,color:'',skin:'',value:false,selectorClass:'pcolorSelector',selectorCss:false,textMS:'Цвета темы',textWEB:'Веб-цвета',textCom:'Стандартные цвета'},u||{});var y='';var z='';for(var i=0;i<w.length;i++){y+='<div style="border-color:#'+w[i]+';background:#'+w[i]+'" data-color="'+w[i]+'" class="colorPicker-pick"><span>&nbsp;</span></div>';if(i==59)y+='<code class="colorPicker-separator">&nbsp;</code><span class="colorPicker-title">'+x.textCom+'</span><code class="colorPicker-separator">&nbsp;</code>'};for(var i=0;i<v.length;i++){z+='<div style="border-color:#'+v[i]+';background:#'+v[i]+'" data-color="'+v[i]+'" class="colorPicker-pick"><span>&nbsp;</span></div>'};$(document).on('mousedown.colorPicker-box',function(a){if(!$(a.target).parents().add(a.target).hasClass('colorPicker-box')){$('.colorPicker-box').fadeOut()}});var A=function(o,c){if(!x.fill)return;o.css('background-color','#'+c).attr('data-color',c)},val=function(t,o,c){if(!x.value||!c)return;if(t=='input')o.val(c);else o.text(c)};return this.each(function(e){var s=$(this),objID=s.attr('id'),tag=document.getElementById(objID).nodeName.toLowerCase(),startColor=s.attr('data-color')||x.color.replace(/[#]/g,'');if(x.selectorCss)s.addClass(x.selectorClass);var t='<div id="colorPicker-'+objID+'" class="colorPicker-box '+x.skin+'">'+'<div id="colorPaletteTabs-'+objID+'" class="colorPicker-palette-tabs">'+'<a class="active" href="#colorTab-MS">'+x.textMS+'</a><a href="#colorTab-WEB">'+x.textWEB+'</a></div>'+'<div id="colorPalette-'+objID+'" class="colorPicker-palette">'+'<div id="colorTab-MS-'+objID+'" class="colorPicker-tab MS"><code class="colorPicker-separator">&nbsp;</code>'+y+'<br clear="all" /><code class="colorPicker-separator">&nbsp;</code></div>'+'<div id="colorTab-WEB-'+objID+'" class="colorPicker-tab WEB">'+z+'<br clear="all" /></div>'+'</div>'+'<div id="colorPreview-'+objID+'" class="colorPicker-preview"></div></div>';$('body').append(t);A(s,startColor);val(tag,s,startColor);$('#colorPaletteTabs-'+objID+' > a').click(function(e){$('#colorPaletteTabs-'+objID+' > a').removeClass('active');$('#colorPalette-'+objID+' > div').hide();var a=$(this),tab=a.attr('href');a.addClass('active');$(tab+'-'+objID).show();return false});$('#colorTab-MS-'+objID+' > div , #colorTab-WEB-'+objID+' > div').hover(function(){var i=$(this),c=i.attr('data-color'),c='#'+c;$("#colorPreview-"+objID).css('background',c);i.addClass('colorPicker-hover')},function(){$(this).removeClass('colorPicker-hover')}).click(function(e){var p=$(this),color=p.attr('data-color');s.attr('data-color',color);$('#colorPicker-'+objID).hide();if(typeof x.onChange=='function')x.onChange.call(this,'#'+color,s);A(s,color);val(tag,s,'#'+color)});s.click(function(e){$("div.colorPicker-box").hide();var f=s.position();var g=f.top;var h=f.left;var i=s.height();var j=s.width();var k=$(window).width();var l=$(window).height();var m=$(window).scrollTop();var n=s.attr('data-color');var o=$('#colorPicker-'+objID).width();var p=$('#colorPicker-'+objID).height();var q=k-(h+j);var r=(l+m)-(g+i);g=g+i;if(o>q)h=h+j-o;if(p>r)g=g-i-p;$('#colorTab-MS-'+objID+' > div , #colorTab-WEB-'+objID+' > div').removeClass('colorPicker-select').each(function(a,b){var d=$(this),c=d.attr('data-color');if(n==c)d.addClass('colorPicker-select')});$('#colorPicker-'+objID).css({top:g,left:h,display:'block'}).hover(function(){},function(){$(this).hide()})})})}})(jQuery);
